<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8"/>
    <title>{{ title }}</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    {% load static %}
    <link href="{% static 'pacientes/css/buscar_paciente.css' %}" rel="stylesheet"/>
</head>
<body>
<div aria-labelledby="main-title" class="container" role="main">
    <h1 id="main-title">{{ header }}</h1>

    <form aria-describedby="form-error" id="buscar-form" method="POST" novalidate>
        {% csrf_token %}
        <div class="form-group">
            <label for="carnet">{{ form_label }}</label>
            <div class="input-group {% if form_error %}error{% endif %}">
                <input
                        id="carnet"
                        name="carnet"
                        placeholder="{{ form_placeholder }}"
                        required
                        type="text"
                        value="{{ carnet }}"
                />
                {% if form_error %}
                <span aria-hidden="true" class="icon-error" title="Error">
                    <svg height="20" width="20">
                        <use href="#icon-error"></use>
                    </svg>
                </span>
                {% endif %}
            </div>
        </div>
        <button aria-label="Buscar paciente por carnet" type="submit">{{ button_label }}</button>
    </form>

    <!-- Contenedor para mensajes de error inyectados vía JS -->
    <div id="respuesta-ajax">
        {% if not paciente and carnet_proporcionado %}
        {% include 'pacientes/partials/mensaje_error.html' %}
        {% endif %}
    </div>
</div>

<!-- Modal del paciente, si ya existe en la carga inicial -->
{% if paciente %}
{% include 'pacientes/partials/modal_paciente.html' %}
{% endif %}

<!-- Ícono SVG de error oculto, para uso con <use> -->
<svg style="display:none;">
    <symbol
            fill="none"
            id="icon-error"
            stroke="#e63946"
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            viewBox="0 0 24 24"
    >
        <circle cx="12" cy="12" r="10"/>
        <line x1="12" x2="12" y1="8" y2="12"/>
        <line x1="12" x2="12" y1="16" y2="16"/>
    </symbol>
</svg>

<!-- Scripts JS externos -->
<script defer src="{% static 'pacientes/js/error_form_handler.js' %}"></script>
<script defer src="{% static 'pacientes/js/buscar_paciente.js' %}"></script>

</body>
</html>
